# DO NOT EDIT
#
# This .travis.yml file generated by Zilla-Dist-[%zilla_dist.version%].
#
# To update it, run:
#
#   > zild update
#

language: perl

matrix:
  include:
    - perl: '5.30'
      env: COVERAGE=1
    - perl: '5.28'
    - perl: '5.26'
    - perl: '5.24'
    - perl: '5.22'
    - perl: '5.20'
    - perl: '5.18'
    - perl: '5.16'
    - perl: '5.14'
    - perl: '5.12'
    - perl: '5.10'

before_install:
- git clone git://github.com/travis-perl/helpers ~/travis-perl-helpers
- source ~/travis-perl-helpers/init
- build-perl
- local-lib cache
- perl -V

install:
[% IF testbase -%]
- git clone --depth=1
  git://github.com/ingydotnet/test-base-pm ../test-base-pm
[% END -%]
[% IF include_testml -%]
- git clone --depth=1
  git://github.com/testml-lang/testml ../testml
[% END -%]
[% IF testml1 -%]
- git clone --depth=1
  git://github.com/ingydotnet/testml1-pm ../testml1-pm
- git clone --depth=1
  git://github.com/ingydotnet/pegex-pm ../pegex-pm
[% END -%]
- cpan-install --coverage
[% FOR module = RequiredModules.sort -%]
[% IF module != 'perl' -%]
  [% module %]
[% END -%]
[% END -%]
[% IF include_testbase -%]
  Test::Base
[% END -%]
[% IF include_testml1 -%]
  TestML1
[% END -%]

before_script:
  coverage-setup

script:
- true &&
[% IF include_testml -%]
  source ../testml/.rc &&
  TESTML_RUN=perl5-tap
[% END -%]
[% IF testbase -%]
  PERL5LIB=../test-base-pm/lib
[% END -%]
  prove -lv test/

after_success:
- coverage-report

[% IF devel.irc -%]
notifications:
  irc:
    channels:
    - [% devel.irc %]
    on_success: change
    on_failure: always
    skip_join: true
[% END -%]

# Hack to not run on tag pushes:
branches:
  except:
  - /^v?[0-9]+\.[0-9]+/
