#
#   This file copied from zilla-dist-pm/pkg/travis.yml
#

language: perl

matrix:
  include:
    - perl: '5.30'
      env: COVERAGE=1
    - perl: '5.28'
    - perl: '5.26'
    - perl: '5.24'
    - perl: '5.22'
    - perl: '5.20'
    - perl: '5.18'
    - perl: '5.16'
    - perl: '5.14'
    - perl: '5.12'
    - perl: '5.10'
    # - perl: '5.8'

before_install:
- git clone git://github.com/travis-perl/helpers ~/travis-perl-helpers
- source ~/travis-perl-helpers/init
- build-perl
- local-lib cache
- perl -V

install:
- cpanm --quiet --notest
  ExtUtils::MakeMaker
  File::Share
  Hash::Merge
  IO::All
  Swim
  Swim::Plugin::badge
  Template::Toolkit::Simple
  version
  YAML::XS

#   CPAN::Uploader
#   Dist::Zilla
#   Dist::Zilla::Plugin::ChangesFromYaml
#   Dist::Zilla::Plugin::GithubMeta
#   Dist::Zilla::Plugin::ReadmeFromPod
#   Dist::Zilla::Plugin::TestBaseIncluder
#   Dist::Zilla::Plugin::TestMLIncluder
#   Dist::Zilla::Plugin::TestML1Includer
#   Dist::Zilla::PluginBundle::Git
- true && [ ! -e test ] || cpan-install --coverage

before_script:
- true && [ ! -e test ] || coverage-setup

script:
- true && [ ! -e test ] || prove -lv test/

after_success:
- coverage-report

notifications:
  irc:
    channels:
    - irc.freenode.net#pkg
    on_success: change
    on_failure: always
    skip_join: true

# Hack to not run on tag pushes:
branches:
  except:
  - /^v?[0-9]+\.[0-9]+/
